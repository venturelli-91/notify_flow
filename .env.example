# ──────────────────────────────────────────────
# NotifyFlow — Environment Variables
# Copy this file to .env and fill in the values.
# NEVER commit .env to source control.
# ──────────────────────────────────────────────

# ── Database (local Docker) ──────────────────
# Main DB on 5434 to avoid conflict with any local Postgres on 5432
DATABASE_URL="postgresql://user:password@localhost:5434/notifyflow"

# ── Database (test — isolated DB, port 5433) ─
TEST_DATABASE_URL="postgresql://user:password@localhost:5433/notifyflow_test"

# ── Redis (local Docker) ─────────────────────
REDIS_URL="redis://localhost:6379"

# ── Email channel (SMTP) ─────────────────────
# Leave blank to disable the email channel (isAvailable() returns false).
# Works with any SMTP provider: Resend, SendGrid, Postmark, AWS SES, etc.
SMTP_HOST="smtp.resend.com"
SMTP_PORT="465"
SMTP_USER="resend"
SMTP_PASS="re_your_api_key_here"
SMTP_FROM="noreply@yourdomain.com"

# ── Webhook channel ───────────────────────────
# Leave blank to disable the webhook channel.
WEBHOOK_URL="https://your-endpoint.com/hook"
WEBHOOK_SECRET="your_bearer_token_here"   # optional — sent as Authorization: Bearer

# ── Authentication ───────────────────────────
# NextAuth secret key (required, min 32 characters)
# Generate with: openssl rand -base64 32
NEXTAUTH_SECRET="your-secret-key-at-least-32-characters-long"

# NextAuth URL (required in production, optional in development)
# In production, set this to your actual domain (e.g., https://yourdomain.com)
NEXTAUTH_URL="http://localhost:3000"

# Legacy API key authentication (deprecated, not currently used)
API_KEY=""

# ── Rate Limiting ────────────────────────────
# Max POST /api/notifications requests per window per IP (default: 20)
RATE_LIMIT_MAX=20
# Window size in seconds (default: 60)
RATE_LIMIT_WINDOW_S=60

# ── Environment ───────────────────────────────
# Application environment (optional, default: development)
# Options: development | production | test
NODE_ENV=development

# ── Trusted Proxy IPs ───────────────────────────────────
# Comma-separated list of reverse-proxy IPs whose X-Forwarded-For header
# is trusted for rate-limit keying. Setting wrong IPs lets attackers spoof
# their IP and bypass rate limits. Defaults to loopback only.
# On Vercel, add Vercel’s edge IP ranges here.
TRUSTED_PROXY_IPS="127.0.0.1,::1,::ffff:127.0.0.1"
# ──────────────────────────────────────────────
# Production overrides (set in Vercel dashboard)
# ──────────────────────────────────────────────
# DATABASE_URL → Neon.tech connection string
#   e.g. "postgresql://user:pass@ep-xxx.us-east-2.aws.neon.tech/notifyflow?sslmode=require"
#
# REDIS_URL    → Upstash URL (note rediss:// for TLS)
#   e.g. "rediss://default:TOKEN@global-XXX.upstash.io:6380"
